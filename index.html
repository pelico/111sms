<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的通知中心</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; background-color: #f0f2f5; color: #1c1e21; }
        .container { max-width: 800px; margin: 20px auto; padding: 20px; }
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #ddd; padding-bottom: 15px; }
        h1 { margin: 0; font-size: 24px; }
        button { background-color: #1877f2; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: bold; }
        button:hover { background-color: #166fe5; }
        #notifications-list { margin-top: 20px; }
        .status-message { text-align: center; color: #65676b; font-size: 18px; padding: 40px 0; }
        .notification-item { background-color: #fff; border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin-bottom: 12px; box-shadow: 0 1px 2px rgba(0,0,0,0.1); word-wrap: break-word; }
        .notification-content { font-size: 16px; }
        .notification-timestamp { font-size: 12px; color: #65676b; margin-top: 8px; text-align: right; }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <h1>通知中心</h1>
            <button onclick="fetchNotifications()">手动刷新</button>
        </div>
        <div id="notifications-list">
            <p class="status-message">正在从服务器加载数据...</p>
        </div>
    </div>

    <script>
        // !!! 【关键】请再次确认这个地址是你的 Worker 地址，并且路径是 /notifications !!!
        const API_ENDPOINT = 'https://jy-api.111312.xyz/notifications';

        const notificationsList = document.getElementById('notifications-list');

        function displayMessage(message, isError = false) {
            notificationsList.innerHTML = `<p class="status-message" style="${isError ? 'color: red;' : ''}">${message}</p>`;
        }

        async function fetchNotifications() {
            displayMessage('正在刷新，请稍候...');
            
            try {
                const response = await fetch(API_ENDPOINT);

                // 如果服务器返回的不是成功状态码 (例如 404, 500)，则抛出错误
                if (!response.ok) {
                    throw new Error(`服务器错误! 状态码: ${response.status} ${response.statusText}`);
                }

                const data = await response.json();

                if (!data.success) {
                    throw new Error(`API返回错误: ${data.error || '未知错误'}`);
                }

                if (data.notifications && data.notifications.length > 0) {
                    notificationsList.innerHTML = ''; // 清空列表
                    data.notifications.forEach(item => {
                        const div = document.createElement('div');
                        div.className = 'notification-item';

                        const content = document.createElement('div');
                        content.className = 'notification-content';
                        content.textContent = item.content;

                        const timestamp = document.createElement('div');
                        timestamp.className = 'notification-timestamp';
                        // 格式化时间，使其更易读
                        const date = new Date(item.timestamp);
                        timestamp.textContent = date.toLocaleString('zh-CN', { dateStyle: 'short', timeStyle: 'medium' });

                        div.appendChild(content);
                        div.appendChild(timestamp);
                        notificationsList.appendChild(div);
                    });
                } else {
                    displayMessage('暂无任何通知。');
                }

            } catch (error) {
                console.error('获取数据时发生严重错误:', error);
                // "Failed to fetch" 错误通常会在这里被捕获
                displayMessage(`加载失败: ${error.message}。请检查浏览器控制台(F12)以获取CORS等详细错误信息。`, true);
            }
        }

        // 页面加载完成后自动执行一次
        document.addEventListener('DOMContentLoaded', fetchNotifications);
    </script>
</body>
</html>
```**操作：** 将此代码更新到你的 GitHub/GitLab 仓库中，Cloudflare Pages 会自动重新部署。

---

### **第三步：如何自己调试**

如果完成以上两步后问题依旧，请按以下方法获取最精确的错误信息：

1.  在电脑上用 Chrome 或 Firefox 浏览器打开你的静态网页。
2.  按下 `F12` 键，打开**开发者工具**。
3.  点击 **"Console" (控制台)** 标签页。
4.  刷新你的网页。
5.  **这时，控制台里大概率会显示一条红色的错误信息，这才是 `Failed to fetch` 背后真正的原因！** 它通常会明确指出是 CORS 问题，例如：
    > Access to fetch at 'https://jy-api.111312.xyz/notifications' from origin 'https://your-project.pages.dev' has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource.

请先完成第一步和第二步，这有极大概率能直接解决问题。如果还不行，请把第三步中看到的**控制台红色错误信息**截图或复制给我，我们就能一击即中。
